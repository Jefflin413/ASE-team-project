{% extends 'base.html' %}

<!DOCTYPE html>
<html>
<head>
  <title>stream</title>
  <link href="http://vjs.zencdn.net/4.12/video-js.css" rel="stylesheet">
  <script src="http://vjs.zencdn.net/4.12/video.js"></script>
  <script src="https://github.com/videojs/videojs-contrib-media-sources/releases/download/v0.1.0/videojs-media-sources.js"></script>
  <script src="https://github.com/videojs/videojs-contrib-hls/releases/download/v0.11.2/videojs.hls.min.js"></script>
</head>
<body>
  {% block content %}	
    <div class="container">
      <div class="row">
        <div class="col-lg-12">
          <div class="content">
	        <form action="/stream" method="post">
	      	  <label for="title">Choose a category that best describes your live-streaming for this time</label>
		      <select name="stream_category" id="stream_category">
 			    <option value="sports">sports</option>
			    <option value="travel & events">travel & events</option>
			    <option value="gaming">gaming</option>
			    <option value="people & blogs">people & blogs</option>
			    <option value="entertainment">entertainment</option>
			    <option value="news & politics">news & politics</option>
			    <option value="education">education</option>
			    <option value="science & technology">science & technology</option>
		      </select>
		      <input type="submit" value="Build pipeline">
	        </form>
	        <div style="color:red;">Please do not close/refresh/resubmit the page after submitting, the work will be done in roughly 5 minutes</div>
	        <div>Once the construction success, the webpage will be refreshed automatically and show the OBS URL, stream key, as well as the video player playing your live-streaming after you click on "start streaming" in OBS</div>
	        <div>In the meanwhile, you can read the instruction of the usage and the installation of <a href="https://obsproject.com/">OBS</a> at the bottom of this <a href="https://aws.amazon.com/tw/blogs/media/part1-how-to-send-live-video-to-aws-elemental-mediastore/">website</a></div>

	        {% if OBS_URL %}
		      <h3>OBS_URL: {{OBS_URL}}</h3>
		      <h3>Stream key: stream</h3>
            <!-- CSS  -->
     		<link href="https://vjs.zencdn.net/7.2.3/video-js.css" rel="stylesheet">
			<!-- HTML -->
			
	 		<!--video id='hls-example'  class="video-js vjs-default-skin" width="400" height="300" controls>
	 			<source type="application/x-mpegURL" src="http://bitdash-a.akamaihd.net/content/MI201109210084_1/m3u8s/f08e80da-bf1d-4e3d-8899-f0f6155f6efa.m3u8">
			</video--> 
			<video id='hls-example'  class="video-js vjs-default-skin" width="400" height="300" controls>
				<source type="application/x-mpegURL" src={{m3u8_URL}}>
			</video>
	 		<!-- JS code -->
	 		<!-- If you'd like to support IE8 (for Video.js versions prior to v7) -->
	 		<script src="https://vjs.zencdn.net/ie8/ie8-version/videojs-ie8.min.js"></script>
	 		<script src="https://cdnjs.cloudflare.com/ajax/libs/videojs-contrib-hls/5.14.1/videojs-contrib-hls.js"></script>
	 		<script src="https://vjs.zencdn.net/7.2.3/video.js"></script>
			<script>
	 			var player = videojs('hls-example');
	 			player.play();
	 		</script>
	        {% endif %}	
          </div>
        </div>
      </div>
    </div>
  {% endblock %}
</body>
</html>
